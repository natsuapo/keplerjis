"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = SidePanelFactory;
exports.StyledSidePanelContent = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _localization = require("../localization");

var _defaultSettings = require("../constants/default-settings");

var _sideBar = _interopRequireDefault(require("./side-panel/side-bar"));

var _panelHeader = _interopRequireDefault(require("./side-panel/panel-header"));

var _panelToggle = _interopRequireDefault(require("./side-panel/panel-toggle"));

var _layerManager = _interopRequireDefault(require("./side-panel/layer-manager"));

var _filterManager = _interopRequireDefault(require("./side-panel/filter-manager"));

var _interactionManager = _interopRequireDefault(require("./side-panel/interaction-manager"));

var _mapManager = _interopRequireDefault(require("./side-panel/map-manager"));

var _customPanel = _interopRequireDefault(require("./side-panel/custom-panel"));

var _panelTitle = _interopRequireDefault(require("./side-panel/panel-title"));

var _processManager = _interopRequireDefault(require("./side-panel/process-manager"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _lodash = _interopRequireDefault(require("lodash.get"));

var _gmtManager = _interopRequireDefault(require("./side-panel/gmt-manager"));

var _templateObject;

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var StyledSidePanelContent = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  ", ";\n  flex-grow: 1;\n  padding: ", "px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n\n  .side-panel__content__inner {\n    display: flex;\n    height: 100%;\n    flex-direction: column;\n  }\n"])), function (props) {
  return props.theme.sidePanelScrollBar;
}, function (props) {
  return props.theme.sidePanelInnerPadding;
});

exports.StyledSidePanelContent = StyledSidePanelContent;
SidePanelFactory.deps = [_sideBar["default"], _panelHeader["default"], _panelToggle["default"], _panelTitle["default"], _layerManager["default"], _filterManager["default"], _interactionManager["default"], _mapManager["default"], _customPanel["default"] // ProcessManagerFactory,
// GMTManagerFactory
];
/**
 * Vertical sidebar containing input components for the rendering layers
 */

function SidePanelFactory(Sidebar, PanelHeader, PanelToggle, PanelTitle, LayerManager, FilterManager, InteractionManager, MapManager, CustomPanels) // ProcessManager,
// GMTManager
{
  // inject components
  var SIDEBAR_COMPONENTS = {
    layer: LayerManager,
    filter: FilterManager,
    interaction: InteractionManager,
    map: MapManager // processor:ProcessManager,
    // gmtprocess:GMTManager

  }; // We should defined sidebar panels here but keeping them for backward compatible

  var fullPanels = _defaultSettings.SIDEBAR_PANELS.map(function (component) {
    return _objectSpread(_objectSpread({}, component), {}, {
      component: SIDEBAR_COMPONENTS[component.id]
    });
  });

  var getCustomPanelProps = (0, _lodash["default"])(CustomPanels, ['defaultProps', 'getProps']) || function () {
    return {};
  };
  /** @type {typeof import('./side-panel').SidePanel} */
  // eslint-disable-next-line max-statements


  var SidePanel = function SidePanel(props) {
    var appName = props.appName,
        appWebsite = props.appWebsite,
        availableProviders = props.availableProviders,
        datasets = props.datasets,
        filters = props.filters,
        layers = props.layers,
        processor = props.processor,
        layerBlending = props.layerBlending,
        layerClasses = props.layerClasses,
        layerOrder = props.layerOrder,
        interactionConfig = props.interactionConfig,
        panels = props.panels,
        mapInfo = props.mapInfo,
        mapSaved = props.mapSaved,
        mapStateActions = props.mapStateActions,
        mapStyle = props.mapStyle,
        mapStyleActions = props.mapStyleActions,
        onSaveMap = props.onSaveMap,
        uiState = props.uiState,
        uiStateActions = props.uiStateActions,
        visStateActions = props.visStateActions,
        version = props.version,
        width = props.width;
    var openDeleteModal = uiStateActions.openDeleteModal,
        toggleModal = uiStateActions.toggleModal,
        toggleSidePanel = uiStateActions.toggleSidePanel;
    var activeSidePanel = uiState.activeSidePanel;
    var setMapInfo = visStateActions.setMapInfo,
        showDatasetTable = visStateActions.showDatasetTable;
    var hasShare = availableProviders.hasShare,
        hasStorage = availableProviders.hasStorage;
    var title = mapInfo.title;
    var isOpen = Boolean(activeSidePanel);

    var _onOpenOrClose = (0, _react.useCallback)(function () {
      return toggleSidePanel(activeSidePanel ? null : 'layer');
    }, [activeSidePanel, toggleSidePanel]);

    var onClickExportImage = (0, _react.useCallback)(function () {
      return toggleModal(_defaultSettings.EXPORT_IMAGE_ID);
    }, [toggleModal]);
    var onClickExportData = (0, _react.useCallback)(function () {
      return toggleModal(_defaultSettings.EXPORT_DATA_ID);
    }, [toggleModal]);
    var onClickExportMap = (0, _react.useCallback)(function () {
      return toggleModal(_defaultSettings.EXPORT_MAP_ID);
    }, [toggleModal]);
    var onClickSaveToStorage = (0, _react.useCallback)(function () {
      return toggleModal(mapSaved ? _defaultSettings.OVERWRITE_MAP_ID : _defaultSettings.SAVE_MAP_ID);
    }, [mapSaved, toggleModal]);
    var onClickSaveAsToStorage = (0, _react.useCallback)(function () {
      setMapInfo({
        title: "".concat(title || 'Kepler.gl', " (Copy)")
      });
      toggleModal(_defaultSettings.SAVE_MAP_ID);
    }, [title, setMapInfo, toggleModal]);
    var onClickShareMap = (0, _react.useCallback)(function () {
      return toggleModal(_defaultSettings.SHARE_MAP_ID);
    }, [toggleModal]);
    var onShowDatasetTable = (0, _react.useCallback)(function (dataId) {
      return showDatasetTable(dataId);
    }, [showDatasetTable]);
    var onShowAddDataModal = (0, _react.useCallback)(function () {
      return toggleModal(_defaultSettings.ADD_DATA_ID);
    }, [toggleModal]);
    var onShowAddMapStyleModal = (0, _react.useCallback)(function () {
      return toggleModal(_defaultSettings.ADD_MAP_STYLE_ID);
    }, [toggleModal]);
    var onRemoveDataset = (0, _react.useCallback)(function (dataId) {
      return openDeleteModal(dataId);
    }, [openDeleteModal]);
    var onSaveToStorage = (0, _react.useMemo)(function () {
      return hasStorage ? onClickSaveToStorage : null;
    }, [hasStorage, onClickSaveToStorage]);
    var onSaveAsToStorage = (0, _react.useMemo)(function () {
      return hasStorage && mapSaved ? onClickSaveAsToStorage : null;
    }, [hasStorage, mapSaved, onClickSaveAsToStorage]);
    var currentPanel = (0, _react.useMemo)(function () {
      return panels.find(function (_ref) {
        var id = _ref.id;
        return id === activeSidePanel;
      }) || {};
    }, [activeSidePanel, panels]);
    var onShareMap = (0, _react.useMemo)(function () {
      return hasShare ? onClickShareMap : null;
    }, [hasShare, onClickShareMap]);
    var customPanelProps = (0, _react.useMemo)(function () {
      return getCustomPanelProps(props);
    }, [props]);
    var PanelComponent = currentPanel.component;
    return /*#__PURE__*/_react["default"].createElement(Sidebar, {
      width: width,
      isOpen: isOpen,
      minifiedWidth: 0,
      onOpenOrClose: _onOpenOrClose
    }, /*#__PURE__*/_react["default"].createElement(PanelHeader, {
      appName: appName,
      version: version,
      appWebsite: appWebsite,
      visibleDropdown: uiState.visibleDropdown,
      showExportDropdown: uiStateActions.showExportDropdown,
      hideExportDropdown: uiStateActions.hideExportDropdown,
      onExportImage: onClickExportImage,
      onExportData: onClickExportData,
      onExportMap: onClickExportMap,
      onSaveMap: onSaveMap,
      onSaveToStorage: onSaveToStorage,
      onSaveAsToStorage: onSaveAsToStorage,
      onShareMap: onShareMap
    }), /*#__PURE__*/_react["default"].createElement(PanelToggle, {
      panels: panels,
      activePanel: activeSidePanel,
      togglePanel: uiStateActions.toggleSidePanel
    }), /*#__PURE__*/_react["default"].createElement(StyledSidePanelContent, {
      className: "side-panel__content"
    }, /*#__PURE__*/_react["default"].createElement("div", {
      className: "side-panel__content__inner"
    }, /*#__PURE__*/_react["default"].createElement(PanelTitle, {
      className: "side-panel__content__title"
    }, /*#__PURE__*/_react["default"].createElement(_localization.FormattedMessage, {
      id: currentPanel.label
    })), PanelComponent ? /*#__PURE__*/_react["default"].createElement(PanelComponent, {
      datasets: datasets,
      filters: filters,
      layers: layers,
      processor: processor,
      layerClasses: layerClasses,
      layerOrder: layerOrder,
      layerBlending: layerBlending,
      mapStyle: mapStyle,
      mapStyleActions: mapStyleActions,
      mapStateActions: mapStateActions,
      interactionConfig: interactionConfig,
      removeDataset: onRemoveDataset,
      showDatasetTable: onShowDatasetTable,
      showAddDataModal: onShowAddDataModal,
      showAddMapStyleModal: onShowAddMapStyleModal,
      uiStateActions: uiStateActions,
      visStateActions: visStateActions
    }) : null, /*#__PURE__*/_react["default"].createElement(CustomPanels, (0, _extends2["default"])({}, customPanelProps, {
      activeSidePanel: activeSidePanel
    })))));
  };

  SidePanel.defaultProps = {
    panels: fullPanels,
    sidebarComponents: SIDEBAR_COMPONENTS,
    uiState: {},
    visStateActions: {},
    mapStyleActions: {},
    uiStateActions: {},
    availableProviders: {},
    mapInfo: {}
  };
  return SidePanel;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21wb25lbnRzL3NpZGUtcGFuZWwuanMiXSwibmFtZXMiOlsiU3R5bGVkU2lkZVBhbmVsQ29udGVudCIsInN0eWxlZCIsImRpdiIsInByb3BzIiwidGhlbWUiLCJzaWRlUGFuZWxTY3JvbGxCYXIiLCJzaWRlUGFuZWxJbm5lclBhZGRpbmciLCJTaWRlUGFuZWxGYWN0b3J5IiwiZGVwcyIsIlNpZGViYXJGYWN0b3J5IiwiUGFuZWxIZWFkZXJGYWN0b3J5IiwiUGFuZWxUb2dnbGVGYWN0b3J5IiwiUGFuZWxUaXRsZUZhY3RvcnkiLCJMYXllck1hbmFnZXJGYWN0b3J5IiwiRmlsdGVyTWFuYWdlckZhY3RvcnkiLCJJbnRlcmFjdGlvbk1hbmFnZXJGYWN0b3J5IiwiTWFwTWFuYWdlckZhY3RvcnkiLCJDdXN0b21QYW5lbHNGYWN0b3J5IiwiU2lkZWJhciIsIlBhbmVsSGVhZGVyIiwiUGFuZWxUb2dnbGUiLCJQYW5lbFRpdGxlIiwiTGF5ZXJNYW5hZ2VyIiwiRmlsdGVyTWFuYWdlciIsIkludGVyYWN0aW9uTWFuYWdlciIsIk1hcE1hbmFnZXIiLCJDdXN0b21QYW5lbHMiLCJTSURFQkFSX0NPTVBPTkVOVFMiLCJsYXllciIsImZpbHRlciIsImludGVyYWN0aW9uIiwibWFwIiwiZnVsbFBhbmVscyIsIlNJREVCQVJfUEFORUxTIiwiY29tcG9uZW50IiwiaWQiLCJnZXRDdXN0b21QYW5lbFByb3BzIiwiU2lkZVBhbmVsIiwiYXBwTmFtZSIsImFwcFdlYnNpdGUiLCJhdmFpbGFibGVQcm92aWRlcnMiLCJkYXRhc2V0cyIsImZpbHRlcnMiLCJsYXllcnMiLCJwcm9jZXNzb3IiLCJsYXllckJsZW5kaW5nIiwibGF5ZXJDbGFzc2VzIiwibGF5ZXJPcmRlciIsImludGVyYWN0aW9uQ29uZmlnIiwicGFuZWxzIiwibWFwSW5mbyIsIm1hcFNhdmVkIiwibWFwU3RhdGVBY3Rpb25zIiwibWFwU3R5bGUiLCJtYXBTdHlsZUFjdGlvbnMiLCJvblNhdmVNYXAiLCJ1aVN0YXRlIiwidWlTdGF0ZUFjdGlvbnMiLCJ2aXNTdGF0ZUFjdGlvbnMiLCJ2ZXJzaW9uIiwid2lkdGgiLCJvcGVuRGVsZXRlTW9kYWwiLCJ0b2dnbGVNb2RhbCIsInRvZ2dsZVNpZGVQYW5lbCIsImFjdGl2ZVNpZGVQYW5lbCIsInNldE1hcEluZm8iLCJzaG93RGF0YXNldFRhYmxlIiwiaGFzU2hhcmUiLCJoYXNTdG9yYWdlIiwidGl0bGUiLCJpc09wZW4iLCJCb29sZWFuIiwiX29uT3Blbk9yQ2xvc2UiLCJvbkNsaWNrRXhwb3J0SW1hZ2UiLCJFWFBPUlRfSU1BR0VfSUQiLCJvbkNsaWNrRXhwb3J0RGF0YSIsIkVYUE9SVF9EQVRBX0lEIiwib25DbGlja0V4cG9ydE1hcCIsIkVYUE9SVF9NQVBfSUQiLCJvbkNsaWNrU2F2ZVRvU3RvcmFnZSIsIk9WRVJXUklURV9NQVBfSUQiLCJTQVZFX01BUF9JRCIsIm9uQ2xpY2tTYXZlQXNUb1N0b3JhZ2UiLCJvbkNsaWNrU2hhcmVNYXAiLCJTSEFSRV9NQVBfSUQiLCJvblNob3dEYXRhc2V0VGFibGUiLCJkYXRhSWQiLCJvblNob3dBZGREYXRhTW9kYWwiLCJBRERfREFUQV9JRCIsIm9uU2hvd0FkZE1hcFN0eWxlTW9kYWwiLCJBRERfTUFQX1NUWUxFX0lEIiwib25SZW1vdmVEYXRhc2V0Iiwib25TYXZlVG9TdG9yYWdlIiwib25TYXZlQXNUb1N0b3JhZ2UiLCJjdXJyZW50UGFuZWwiLCJmaW5kIiwib25TaGFyZU1hcCIsImN1c3RvbVBhbmVsUHJvcHMiLCJQYW5lbENvbXBvbmVudCIsInZpc2libGVEcm9wZG93biIsInNob3dFeHBvcnREcm9wZG93biIsImhpZGVFeHBvcnREcm9wZG93biIsImxhYmVsIiwiZGVmYXVsdFByb3BzIiwic2lkZWJhckNvbXBvbmVudHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW9CQTs7QUFDQTs7QUFFQTs7QUFZQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7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LGlCQUFpQixFQUFFN0Usa0JBRkk7QUFHdkI2QixJQUFBQSxPQUFPLEVBQUUsRUFIYztBQUl2QkUsSUFBQUEsZUFBZSxFQUFFLEVBSk07QUFLdkJKLElBQUFBLGVBQWUsRUFBRSxFQUxNO0FBTXZCRyxJQUFBQSxjQUFjLEVBQUUsRUFOTztBQU92QmpCLElBQUFBLGtCQUFrQixFQUFFLEVBUEc7QUFRdkJVLElBQUFBLE9BQU8sRUFBRTtBQVJjLEdBQXpCO0FBV0EsU0FBT2IsU0FBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDIyIFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbi8vIFRIRSBTT0ZUV0FSRS5cblxuaW1wb3J0IFJlYWN0LCB7dXNlQ2FsbGJhY2ssIHVzZU1lbW99IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7Rm9ybWF0dGVkTWVzc2FnZX0gZnJvbSAnbG9jYWxpemF0aW9uJztcblxuaW1wb3J0IHtcbiAgRVhQT1JUX0RBVEFfSUQsXG4gIEVYUE9SVF9NQVBfSUQsXG4gIFNIQVJFX01BUF9JRCxcbiAgU0lERUJBUl9QQU5FTFMsXG4gIE9WRVJXUklURV9NQVBfSUQsXG4gIFNBVkVfTUFQX0lELFxuICBFWFBPUlRfSU1BR0VfSUQsXG4gIEFERF9EQVRBX0lELFxuICBBRERfTUFQX1NUWUxFX0lEXG59IGZyb20gJ2NvbnN0YW50cy9kZWZhdWx0LXNldHRpbmdzJztcblxuaW1wb3J0IFNpZGViYXJGYWN0b3J5IGZyb20gJy4vc2lkZS1wYW5lbC9zaWRlLWJhcic7XG5pbXBvcnQgUGFuZWxIZWFkZXJGYWN0b3J5IGZyb20gJy4vc2lkZS1wYW5lbC9wYW5lbC1oZWFkZXInO1xuaW1wb3J0IFBhbmVsVG9nZ2xlRmFjdG9yeSBmcm9tICcuL3NpZGUtcGFuZWwvcGFuZWwtdG9nZ2xlJztcbmltcG9ydCBMYXllck1hbmFnZXJGYWN0b3J5IGZyb20gJy4vc2lkZS1wYW5lbC9sYXllci1tYW5hZ2VyJztcbmltcG9ydCBGaWx0ZXJNYW5hZ2VyRmFjdG9yeSBmcm9tICcuL3NpZGUtcGFuZWwvZmlsdGVyLW1hbmFnZXInO1xuaW1wb3J0IEludGVyYWN0aW9uTWFuYWdlckZhY3RvcnkgZnJvbSAnLi9zaWRlLXBhbmVsL2ludGVyYWN0aW9uLW1hbmFnZXInO1xuaW1wb3J0IE1hcE1hbmFnZXJGYWN0b3J5IGZyb20gJy4vc2lkZS1wYW5lbC9tYXAtbWFuYWdlcic7XG5pbXBvcnQgQ3VzdG9tUGFuZWxzRmFjdG9yeSBmcm9tICcuL3NpZGUtcGFuZWwvY3VzdG9tLXBhbmVsJztcbmltcG9ydCBQYW5lbFRpdGxlRmFjdG9yeSBmcm9tICcuL3NpZGUtcGFuZWwvcGFuZWwtdGl0bGUnO1xuaW1wb3J0IFByb2Nlc3NNYW5hZ2VyRmFjdG9yeSBmcm9tICcuL3NpZGUtcGFuZWwvcHJvY2Vzcy1tYW5hZ2VyJztcblxuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgZ2V0IGZyb20gJ2xvZGFzaC5nZXQnO1xuaW1wb3J0IEdNVE1hbmFnZXJGYWN0b3J5IGZyb20gJy4vc2lkZS1wYW5lbC9nbXQtbWFuYWdlcic7XG5cblxuZXhwb3J0IGNvbnN0IFN0eWxlZFNpZGVQYW5lbENvbnRlbnQgPSBzdHlsZWQuZGl2YFxuICAke3Byb3BzID0+IHByb3BzLnRoZW1lLnNpZGVQYW5lbFNjcm9sbEJhcn07XG4gIGZsZXgtZ3JvdzogMTtcbiAgcGFkZGluZzogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5zaWRlUGFuZWxJbm5lclBhZGRpbmd9cHg7XG4gIG92ZXJmbG93LXk6IHNjcm9sbDtcbiAgb3ZlcmZsb3cteDogaGlkZGVuO1xuXG4gIC5zaWRlLXBhbmVsX19jb250ZW50X19pbm5lciB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgfVxuYDtcblxuXG5TaWRlUGFuZWxGYWN0b3J5LmRlcHMgPSBbXG4gIFNpZGViYXJGYWN0b3J5LFxuICBQYW5lbEhlYWRlckZhY3RvcnksXG4gIFBhbmVsVG9nZ2xlRmFjdG9yeSxcbiAgUGFuZWxUaXRsZUZhY3RvcnksXG4gIExheWVyTWFuYWdlckZhY3RvcnksXG4gIEZpbHRlck1hbmFnZXJGYWN0b3J5LFxuICBJbnRlcmFjdGlvbk1hbmFnZXJGYWN0b3J5LFxuICBNYXBNYW5hZ2VyRmFjdG9yeSxcbiAgQ3VzdG9tUGFuZWxzRmFjdG9yeSxcbiAgLy8gUHJvY2Vzc01hbmFnZXJGYWN0b3J5LFxuICAvLyBHTVRNYW5hZ2VyRmFjdG9yeVxuXTtcblxuLyoqXG4gKiBWZXJ0aWNhbCBzaWRlYmFyIGNvbnRhaW5pbmcgaW5wdXQgY29tcG9uZW50cyBmb3IgdGhlIHJlbmRlcmluZyBsYXllcnNcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gU2lkZVBhbmVsRmFjdG9yeShcbiAgU2lkZWJhcixcbiAgUGFuZWxIZWFkZXIsXG4gIFBhbmVsVG9nZ2xlLFxuICBQYW5lbFRpdGxlLFxuICBMYXllck1hbmFnZXIsXG4gIEZpbHRlck1hbmFnZXIsXG4gIEludGVyYWN0aW9uTWFuYWdlcixcbiAgTWFwTWFuYWdlcixcbiAgQ3VzdG9tUGFuZWxzLFxuICAvLyBQcm9jZXNzTWFuYWdlcixcbiAgLy8gR01UTWFuYWdlclxuKSB7XG4gIC8vIGluamVjdCBjb21wb25lbnRzXG4gIGNvbnN0IFNJREVCQVJfQ09NUE9ORU5UUyA9IHtcbiAgICBsYXllcjogTGF5ZXJNYW5hZ2VyLFxuICAgIGZpbHRlcjogRmlsdGVyTWFuYWdlcixcbiAgICBpbnRlcmFjdGlvbjogSW50ZXJhY3Rpb25NYW5hZ2VyLFxuICAgIG1hcDogTWFwTWFuYWdlcixcbiAgICAvLyBwcm9jZXNzb3I6UHJvY2Vzc01hbmFnZXIsXG4gICAgLy8gZ210cHJvY2VzczpHTVRNYW5hZ2VyXG4gIH07XG5cbiAgLy8gV2Ugc2hvdWxkIGRlZmluZWQgc2lkZWJhciBwYW5lbHMgaGVyZSBidXQga2VlcGluZyB0aGVtIGZvciBiYWNrd2FyZCBjb21wYXRpYmxlXG4gIGNvbnN0IGZ1bGxQYW5lbHMgPSBTSURFQkFSX1BBTkVMUy5tYXAoY29tcG9uZW50ID0+ICh7XG4gICAgLi4uY29tcG9uZW50LFxuICAgIGNvbXBvbmVudDogU0lERUJBUl9DT01QT05FTlRTW2NvbXBvbmVudC5pZF1cbiAgfSkpO1xuXG4gIGNvbnN0IGdldEN1c3RvbVBhbmVsUHJvcHMgPSBnZXQoQ3VzdG9tUGFuZWxzLCBbJ2RlZmF1bHRQcm9wcycsICdnZXRQcm9wcyddKSB8fCAoKCkgPT4gKHt9KSk7XG5cbiAgLyoqIEB0eXBlIHt0eXBlb2YgaW1wb3J0KCcuL3NpZGUtcGFuZWwnKS5TaWRlUGFuZWx9ICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtc3RhdGVtZW50c1xuICBjb25zdCBTaWRlUGFuZWwgPSBwcm9wcyA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgYXBwTmFtZSxcbiAgICAgIGFwcFdlYnNpdGUsXG4gICAgICBhdmFpbGFibGVQcm92aWRlcnMsXG4gICAgICBkYXRhc2V0cyxcbiAgICAgIGZpbHRlcnMsXG4gICAgICBsYXllcnMsXG4gICAgICBwcm9jZXNzb3IsXG4gICAgICBsYXllckJsZW5kaW5nLFxuICAgICAgbGF5ZXJDbGFzc2VzLFxuICAgICAgbGF5ZXJPcmRlcixcbiAgICAgIGludGVyYWN0aW9uQ29uZmlnLFxuICAgICAgcGFuZWxzLFxuICAgICAgbWFwSW5mbyxcbiAgICAgIG1hcFNhdmVkLFxuICAgICAgbWFwU3RhdGVBY3Rpb25zLFxuICAgICAgbWFwU3R5bGUsXG4gICAgICBtYXBTdHlsZUFjdGlvbnMsXG4gICAgICBvblNhdmVNYXAsXG4gICAgICB1aVN0YXRlLFxuICAgICAgdWlTdGF0ZUFjdGlvbnMsXG4gICAgICB2aXNTdGF0ZUFjdGlvbnMsXG4gICAgICB2ZXJzaW9uLFxuICAgICAgd2lkdGhcbiAgICB9ID0gcHJvcHM7XG4gICAgY29uc3Qge29wZW5EZWxldGVNb2RhbCwgdG9nZ2xlTW9kYWwsIHRvZ2dsZVNpZGVQYW5lbH0gPSB1aVN0YXRlQWN0aW9ucztcbiAgICBjb25zdCB7YWN0aXZlU2lkZVBhbmVsfSA9IHVpU3RhdGU7XG4gICAgY29uc3Qge3NldE1hcEluZm8sIHNob3dEYXRhc2V0VGFibGV9ID0gdmlzU3RhdGVBY3Rpb25zO1xuICAgIGNvbnN0IHtoYXNTaGFyZSwgaGFzU3RvcmFnZX0gPSBhdmFpbGFibGVQcm92aWRlcnM7XG5cbiAgICBjb25zdCB7dGl0bGV9ID0gbWFwSW5mbztcblxuICAgIGNvbnN0IGlzT3BlbiA9IEJvb2xlYW4oYWN0aXZlU2lkZVBhbmVsKTtcblxuICAgIGNvbnN0IF9vbk9wZW5PckNsb3NlID0gdXNlQ2FsbGJhY2soKCkgPT4gdG9nZ2xlU2lkZVBhbmVsKGFjdGl2ZVNpZGVQYW5lbCA/IG51bGwgOiAnbGF5ZXInKSwgW1xuICAgICAgYWN0aXZlU2lkZVBhbmVsLFxuICAgICAgdG9nZ2xlU2lkZVBhbmVsXG4gICAgXSk7XG5cbiAgICBjb25zdCBvbkNsaWNrRXhwb3J0SW1hZ2UgPSB1c2VDYWxsYmFjaygoKSA9PiB0b2dnbGVNb2RhbChFWFBPUlRfSU1BR0VfSUQpLCBbdG9nZ2xlTW9kYWxdKTtcbiAgICBjb25zdCBvbkNsaWNrRXhwb3J0RGF0YSA9IHVzZUNhbGxiYWNrKCgpID0+IHRvZ2dsZU1vZGFsKEVYUE9SVF9EQVRBX0lEKSwgW3RvZ2dsZU1vZGFsXSk7XG4gICAgY29uc3Qgb25DbGlja0V4cG9ydE1hcCA9IHVzZUNhbGxiYWNrKCgpID0+IHRvZ2dsZU1vZGFsKEVYUE9SVF9NQVBfSUQpLCBbdG9nZ2xlTW9kYWxdKTtcbiAgICBjb25zdCBvbkNsaWNrU2F2ZVRvU3RvcmFnZSA9IHVzZUNhbGxiYWNrKFxuICAgICAgKCkgPT4gdG9nZ2xlTW9kYWwobWFwU2F2ZWQgPyBPVkVSV1JJVEVfTUFQX0lEIDogU0FWRV9NQVBfSUQpLFxuICAgICAgW21hcFNhdmVkLCB0b2dnbGVNb2RhbF1cbiAgICApO1xuICAgIGNvbnN0IG9uQ2xpY2tTYXZlQXNUb1N0b3JhZ2UgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICBzZXRNYXBJbmZvKHtcbiAgICAgICAgdGl0bGU6IGAke3RpdGxlIHx8ICdLZXBsZXIuZ2wnfSAoQ29weSlgXG4gICAgICB9KTtcblxuICAgICAgdG9nZ2xlTW9kYWwoU0FWRV9NQVBfSUQpO1xuICAgIH0sIFt0aXRsZSwgc2V0TWFwSW5mbywgdG9nZ2xlTW9kYWxdKTtcbiAgICBjb25zdCBvbkNsaWNrU2hhcmVNYXAgPSB1c2VDYWxsYmFjaygoKSA9PiB0b2dnbGVNb2RhbChTSEFSRV9NQVBfSUQpLCBbdG9nZ2xlTW9kYWxdKTtcbiAgICBjb25zdCBvblNob3dEYXRhc2V0VGFibGUgPSB1c2VDYWxsYmFjayhkYXRhSWQgPT4gc2hvd0RhdGFzZXRUYWJsZShkYXRhSWQpLCBbc2hvd0RhdGFzZXRUYWJsZV0pO1xuICAgIGNvbnN0IG9uU2hvd0FkZERhdGFNb2RhbCA9IHVzZUNhbGxiYWNrKCgpID0+IHRvZ2dsZU1vZGFsKEFERF9EQVRBX0lEKSwgW3RvZ2dsZU1vZGFsXSk7XG4gICAgY29uc3Qgb25TaG93QWRkTWFwU3R5bGVNb2RhbCA9IHVzZUNhbGxiYWNrKCgpID0+IHRvZ2dsZU1vZGFsKEFERF9NQVBfU1RZTEVfSUQpLCBbdG9nZ2xlTW9kYWxdKTtcbiAgICBjb25zdCBvblJlbW92ZURhdGFzZXQgPSB1c2VDYWxsYmFjayhkYXRhSWQgPT4gb3BlbkRlbGV0ZU1vZGFsKGRhdGFJZCksIFtvcGVuRGVsZXRlTW9kYWxdKTtcbiAgICBjb25zdCBvblNhdmVUb1N0b3JhZ2UgPSB1c2VNZW1vKCgpID0+ICgoaGFzU3RvcmFnZSA/IG9uQ2xpY2tTYXZlVG9TdG9yYWdlIDogbnVsbCkpLCBbXG4gICAgICBoYXNTdG9yYWdlLFxuICAgICAgb25DbGlja1NhdmVUb1N0b3JhZ2VcbiAgICBdKTtcbiAgICBjb25zdCBvblNhdmVBc1RvU3RvcmFnZSA9IHVzZU1lbW8oXG4gICAgICAoKSA9PiAoKGhhc1N0b3JhZ2UgJiYgbWFwU2F2ZWQgPyBvbkNsaWNrU2F2ZUFzVG9TdG9yYWdlIDogbnVsbCkpLFxuICAgICAgW2hhc1N0b3JhZ2UsIG1hcFNhdmVkLCBvbkNsaWNrU2F2ZUFzVG9TdG9yYWdlXVxuICAgICk7XG4gICAgY29uc3QgY3VycmVudFBhbmVsID0gdXNlTWVtbygoKSA9PiBwYW5lbHMuZmluZCgoe2lkfSkgPT4gaWQgPT09IGFjdGl2ZVNpZGVQYW5lbCkgfHwge30sIFtcbiAgICAgIGFjdGl2ZVNpZGVQYW5lbCxcbiAgICAgIHBhbmVsc1xuICAgIF0pO1xuICAgIGNvbnN0IG9uU2hhcmVNYXAgPSB1c2VNZW1vKCgpID0+ICgoaGFzU2hhcmUgPyBvbkNsaWNrU2hhcmVNYXAgOiBudWxsKSksIFtcbiAgICAgIGhhc1NoYXJlLFxuICAgICAgb25DbGlja1NoYXJlTWFwXG4gICAgXSk7XG4gICAgY29uc3QgY3VzdG9tUGFuZWxQcm9wcyA9IHVzZU1lbW8oKCkgPT4gZ2V0Q3VzdG9tUGFuZWxQcm9wcyhwcm9wcyksIFtwcm9wc10pO1xuICAgIGNvbnN0IFBhbmVsQ29tcG9uZW50ID0gY3VycmVudFBhbmVsLmNvbXBvbmVudDtcblxuICAgIHJldHVybiAoXG4gICAgICA8U2lkZWJhciB3aWR0aD17d2lkdGh9IGlzT3Blbj17aXNPcGVufSBtaW5pZmllZFdpZHRoPXswfSBvbk9wZW5PckNsb3NlPXtfb25PcGVuT3JDbG9zZX0+XG4gICAgICAgIDxQYW5lbEhlYWRlclxuICAgICAgICAgIGFwcE5hbWU9e2FwcE5hbWV9XG4gICAgICAgICAgdmVyc2lvbj17dmVyc2lvbn1cbiAgICAgICAgICBhcHBXZWJzaXRlPXthcHBXZWJzaXRlfVxuICAgICAgICAgIHZpc2libGVEcm9wZG93bj17dWlTdGF0ZS52aXNpYmxlRHJvcGRvd259XG4gICAgICAgICAgc2hvd0V4cG9ydERyb3Bkb3duPXt1aVN0YXRlQWN0aW9ucy5zaG93RXhwb3J0RHJvcGRvd259XG4gICAgICAgICAgaGlkZUV4cG9ydERyb3Bkb3duPXt1aVN0YXRlQWN0aW9ucy5oaWRlRXhwb3J0RHJvcGRvd259XG4gICAgICAgICAgb25FeHBvcnRJbWFnZT17b25DbGlja0V4cG9ydEltYWdlfVxuICAgICAgICAgIG9uRXhwb3J0RGF0YT17b25DbGlja0V4cG9ydERhdGF9XG4gICAgICAgICAgb25FeHBvcnRNYXA9e29uQ2xpY2tFeHBvcnRNYXB9XG4gICAgICAgICAgb25TYXZlTWFwPXtvblNhdmVNYXB9XG4gICAgICAgICAgb25TYXZlVG9TdG9yYWdlPXtvblNhdmVUb1N0b3JhZ2V9XG4gICAgICAgICAgb25TYXZlQXNUb1N0b3JhZ2U9e29uU2F2ZUFzVG9TdG9yYWdlfVxuICAgICAgICAgIG9uU2hhcmVNYXA9e29uU2hhcmVNYXB9XG4gICAgICAgIC8+XG4gICAgICAgIHsvKiB0aGUgbmV4dCB0d28gY29tcG9uZW50cyBzaG91bGQgYmUgbW92ZWQgaW50byBvbmUgKi99XG4gICAgICAgIHsvKiBidXQgaSBhbSBrZWVwaW5nIHRoZW0gYmVjYXVzZSBvZiBiYWNrd2FyZCBjb21wYXRpYmlsaXR5ICovfVxuICAgICAgICA8UGFuZWxUb2dnbGVcbiAgICAgICAgICBwYW5lbHM9e3BhbmVsc31cbiAgICAgICAgICBhY3RpdmVQYW5lbD17YWN0aXZlU2lkZVBhbmVsfVxuICAgICAgICAgIHRvZ2dsZVBhbmVsPXt1aVN0YXRlQWN0aW9ucy50b2dnbGVTaWRlUGFuZWx9XG4gICAgICAgIC8+XG4gICAgICAgIDxTdHlsZWRTaWRlUGFuZWxDb250ZW50IGNsYXNzTmFtZT1cInNpZGUtcGFuZWxfX2NvbnRlbnRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNpZGUtcGFuZWxfX2NvbnRlbnRfX2lubmVyXCI+XG4gICAgICAgICAgICA8UGFuZWxUaXRsZSBjbGFzc05hbWU9XCJzaWRlLXBhbmVsX19jb250ZW50X190aXRsZVwiPlxuICAgICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD17Y3VycmVudFBhbmVsLmxhYmVsfSAvPlxuICAgICAgICAgICAgPC9QYW5lbFRpdGxlPlxuICAgICAgICAgICAge1BhbmVsQ29tcG9uZW50ID8gKFxuICAgICAgICAgICAgICA8UGFuZWxDb21wb25lbnRcbiAgICAgICAgICAgICAgICBkYXRhc2V0cz17ZGF0YXNldHN9XG4gICAgICAgICAgICAgICAgZmlsdGVycz17ZmlsdGVyc31cbiAgICAgICAgICAgICAgICBsYXllcnM9e2xheWVyc31cbiAgICAgICAgICAgICAgICBwcm9jZXNzb3I9e3Byb2Nlc3Nvcn1cbiAgICAgICAgICAgICAgICBsYXllckNsYXNzZXM9e2xheWVyQ2xhc3Nlc31cbiAgICAgICAgICAgICAgICBsYXllck9yZGVyPXtsYXllck9yZGVyfVxuICAgICAgICAgICAgICAgIGxheWVyQmxlbmRpbmc9e2xheWVyQmxlbmRpbmd9XG4gICAgICAgICAgICAgICAgbWFwU3R5bGU9e21hcFN0eWxlfVxuICAgICAgICAgICAgICAgIG1hcFN0eWxlQWN0aW9ucz17bWFwU3R5bGVBY3Rpb25zfVxuICAgICAgICAgICAgICAgIG1hcFN0YXRlQWN0aW9ucz17bWFwU3RhdGVBY3Rpb25zfVxuICAgICAgICAgICAgICAgIGludGVyYWN0aW9uQ29uZmlnPXtpbnRlcmFjdGlvbkNvbmZpZ31cbiAgICAgICAgICAgICAgICByZW1vdmVEYXRhc2V0PXtvblJlbW92ZURhdGFzZXR9XG4gICAgICAgICAgICAgICAgc2hvd0RhdGFzZXRUYWJsZT17b25TaG93RGF0YXNldFRhYmxlfVxuICAgICAgICAgICAgICAgIHNob3dBZGREYXRhTW9kYWw9e29uU2hvd0FkZERhdGFNb2RhbH1cbiAgICAgICAgICAgICAgICBzaG93QWRkTWFwU3R5bGVNb2RhbD17b25TaG93QWRkTWFwU3R5bGVNb2RhbH1cbiAgICAgICAgICAgICAgICB1aVN0YXRlQWN0aW9ucz17dWlTdGF0ZUFjdGlvbnN9XG4gICAgICAgICAgICAgICAgdmlzU3RhdGVBY3Rpb25zPXt2aXNTdGF0ZUFjdGlvbnN9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgIDxDdXN0b21QYW5lbHMgey4uLmN1c3RvbVBhbmVsUHJvcHN9IGFjdGl2ZVNpZGVQYW5lbD17YWN0aXZlU2lkZVBhbmVsfSAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L1N0eWxlZFNpZGVQYW5lbENvbnRlbnQ+XG4gICAgICA8L1NpZGViYXI+XG4gICAgKTtcbiAgfTtcblxuICBTaWRlUGFuZWwuZGVmYXVsdFByb3BzID0ge1xuICAgIHBhbmVsczogZnVsbFBhbmVscyxcbiAgICBzaWRlYmFyQ29tcG9uZW50czogU0lERUJBUl9DT01QT05FTlRTLFxuICAgIHVpU3RhdGU6IHt9LFxuICAgIHZpc1N0YXRlQWN0aW9uczoge30sXG4gICAgbWFwU3R5bGVBY3Rpb25zOiB7fSxcbiAgICB1aVN0YXRlQWN0aW9uczoge30sXG4gICAgYXZhaWxhYmxlUHJvdmlkZXJzOiB7fSxcbiAgICBtYXBJbmZvOiB7fVxuICB9O1xuXG4gIHJldHVybiBTaWRlUGFuZWw7XG59XG4iXX0=