"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.UNWRAP_TASK = exports.DELAY_TASK = exports.ACTION_TASK = exports.GET_SAVED_MAPS_TASK = exports.LOAD_CLOUD_MAP_TASK = exports.EXPORT_FILE_TO_CLOUD_TASK = exports.LOAD_API_TASK = exports.LOAD_MAP_STYLE_TASK = exports.GEOCODING_GOOGLE_REQUEST = exports.PROCESS_FILE_DATA = exports.LOAD_FILE_TASK = void 0;

var _tasks = _interopRequireWildcard(require("react-palm/tasks"));

var _d3Request = require("d3-request");

var _fileHandler = require("../processors/file-handler");

// Copyright (c) 2022 Uber Technologies, Inc.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.
var LOAD_FILE_TASK = _tasks["default"].fromPromise(function (_ref) {
  var file = _ref.file,
      fileCache = _ref.fileCache,
      loaders = _ref.loaders,
      loadOptions = _ref.loadOptions;
  return (0, _fileHandler.readFileInBatches)({
    file: file,
    fileCache: fileCache,
    loaders: loaders,
    loadOptions: loadOptions
  });
}, 'LOAD_FILE_TASK');

exports.LOAD_FILE_TASK = LOAD_FILE_TASK;

var PROCESS_FILE_DATA = _tasks["default"].fromPromise(_fileHandler.processFileData, 'PROCESS_FILE_CONTENT');

exports.PROCESS_FILE_DATA = PROCESS_FILE_DATA;

var GEOCODING_GOOGLE_REQUEST = _tasks["default"].fromPromise('LOAD_GEOCODING_RESULT'); // export const PLACE_DETAIL_TASK = taskCreator(
// requestJson(url,(err,result))
// )
// export const PROCESS_LAYER_TASK = taskCreator({
//   processLayerData,
//   'PROCESS_LAYER_TASK'
// })


exports.GEOCODING_GOOGLE_REQUEST = GEOCODING_GOOGLE_REQUEST;
var LOAD_MAP_STYLE_TASK = (0, _tasks.taskCreator)(function (_ref2, success, error) {
  var url = _ref2.url,
      id = _ref2.id;
  return (0, _d3Request.json)(url, function (err, result) {
    if (err) {
      error(err);
    } else {
      if (!result) {
        error(new Error('Map style response is empty'));
      }

      success({
        id: id,
        style: result
      });
    }
  });
}, 'LOAD_MAP_STYLE_TASK');
exports.LOAD_MAP_STYLE_TASK = LOAD_MAP_STYLE_TASK;
var LOAD_API_TASK = (0, _tasks.taskCreator)(function (url, success, error) {
  return (0, _d3Request.json)(url, function (err, result) {
    if (err) {
      error(err);
    } else {
      if (!result) {
        error(new Error('Map style response is empty'));
      }

      success(result);
    }
  });
}, 'LOAD_API_TASK');
/**
 * task to upload file to cloud provider
 */

exports.LOAD_API_TASK = LOAD_API_TASK;

var EXPORT_FILE_TO_CLOUD_TASK = _tasks["default"].fromPromise(function (_ref3) {
  var provider = _ref3.provider,
      payload = _ref3.payload;
  return provider.uploadMap(payload);
}, 'EXPORT_FILE_TO_CLOUD_TASK');

exports.EXPORT_FILE_TO_CLOUD_TASK = EXPORT_FILE_TO_CLOUD_TASK;

var LOAD_CLOUD_MAP_TASK = _tasks["default"].fromPromise(function (_ref4) {
  var provider = _ref4.provider,
      payload = _ref4.payload;
  return provider.downloadMap(payload);
}, 'LOAD_CLOUD_MAP_TASK');

exports.LOAD_CLOUD_MAP_TASK = LOAD_CLOUD_MAP_TASK;

var GET_SAVED_MAPS_TASK = _tasks["default"].fromPromise(function (provider) {
  return provider.listMaps();
}, 'GET_SAVED_MAPS_TASK');
/**
 *  task to dispatch a function as a task
 */


exports.GET_SAVED_MAPS_TASK = GET_SAVED_MAPS_TASK;

var ACTION_TASK = _tasks["default"].fromCallback(function (_, cb) {
  return cb();
}, 'ACTION_TASK');

exports.ACTION_TASK = ACTION_TASK;

var DELAY_TASK = _tasks["default"].fromCallback(function (delay, cb) {
  return window.setTimeout(function () {
    return cb();
  }, delay);
}, 'DELAY_TASK');

exports.DELAY_TASK = DELAY_TASK;

var UNWRAP_TASK = _tasks["default"].fromPromise(function (promise) {
  return promise;
}, 'UNWRAP');

exports.UNWRAP_TASK = UNWRAP_TASK;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90YXNrcy90YXNrcy5qcyJdLCJuYW1lcyI6WyJMT0FEX0ZJTEVfVEFTSyIsIlRhc2siLCJmcm9tUHJvbWlzZSIsImZpbGUiLCJmaWxlQ2FjaGUiLCJsb2FkZXJzIiwibG9hZE9wdGlvbnMiLCJQUk9DRVNTX0ZJTEVfREFUQSIsInByb2Nlc3NGaWxlRGF0YSIsIkdFT0NPRElOR19HT09HTEVfUkVRVUVTVCIsIkxPQURfTUFQX1NUWUxFX1RBU0siLCJzdWNjZXNzIiwiZXJyb3IiLCJ1cmwiLCJpZCIsImVyciIsInJlc3VsdCIsIkVycm9yIiwic3R5bGUiLCJMT0FEX0FQSV9UQVNLIiwiRVhQT1JUX0ZJTEVfVE9fQ0xPVURfVEFTSyIsInByb3ZpZGVyIiwicGF5bG9hZCIsInVwbG9hZE1hcCIsIkxPQURfQ0xPVURfTUFQX1RBU0siLCJkb3dubG9hZE1hcCIsIkdFVF9TQVZFRF9NQVBTX1RBU0siLCJsaXN0TWFwcyIsIkFDVElPTl9UQVNLIiwiZnJvbUNhbGxiYWNrIiwiXyIsImNiIiwiREVMQVlfVEFTSyIsImRlbGF5Iiwid2luZG93Iiwic2V0VGltZW91dCIsIlVOV1JBUF9UQVNLIiwicHJvbWlzZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBb0JBOztBQUNBOztBQUNBOztBQXRCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1PLElBQU1BLGNBQWMsR0FBR0Msa0JBQUtDLFdBQUwsQ0FDNUI7QUFBQSxNQUFFQyxJQUFGLFFBQUVBLElBQUY7QUFBQSxNQUFRQyxTQUFSLFFBQVFBLFNBQVI7QUFBQSxNQUFtQkMsT0FBbkIsUUFBbUJBLE9BQW5CO0FBQUEsTUFBNEJDLFdBQTVCLFFBQTRCQSxXQUE1QjtBQUFBLFNBQ0Usb0NBQWtCO0FBQUNILElBQUFBLElBQUksRUFBSkEsSUFBRDtBQUFPQyxJQUFBQSxTQUFTLEVBQVRBLFNBQVA7QUFBa0JDLElBQUFBLE9BQU8sRUFBUEEsT0FBbEI7QUFBMkJDLElBQUFBLFdBQVcsRUFBWEE7QUFBM0IsR0FBbEIsQ0FERjtBQUFBLENBRDRCLEVBRzVCLGdCQUg0QixDQUF2Qjs7OztBQU1BLElBQU1DLGlCQUFpQixHQUFHTixrQkFBS0MsV0FBTCxDQUMvQk0sNEJBRCtCLEVBRy9CLHNCQUgrQixDQUExQjs7OztBQU1BLElBQU1DLHdCQUF3QixHQUFHUixrQkFBS0MsV0FBTCxDQUN0Qyx1QkFEc0MsQ0FBakMsQyxDQUlQO0FBQ007QUFDTjtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBRU8sSUFBTVEsbUJBQW1CLEdBQUcsd0JBQ2pDLGlCQUFZQyxPQUFaLEVBQXFCQyxLQUFyQjtBQUFBLE1BQUVDLEdBQUYsU0FBRUEsR0FBRjtBQUFBLE1BQU9DLEVBQVAsU0FBT0EsRUFBUDtBQUFBLFNBQ0UscUJBQVlELEdBQVosRUFBaUIsVUFBQ0UsR0FBRCxFQUFNQyxNQUFOLEVBQWlCO0FBQ2hDLFFBQUlELEdBQUosRUFBUztBQUNQSCxNQUFBQSxLQUFLLENBQUNHLEdBQUQsQ0FBTDtBQUNELEtBRkQsTUFFTztBQUNMLFVBQUksQ0FBQ0MsTUFBTCxFQUFhO0FBQ1hKLFFBQUFBLEtBQUssQ0FBQyxJQUFJSyxLQUFKLENBQVUsNkJBQVYsQ0FBRCxDQUFMO0FBQ0Q7O0FBQ0ROLE1BQUFBLE9BQU8sQ0FBQztBQUFDRyxRQUFBQSxFQUFFLEVBQUZBLEVBQUQ7QUFBS0ksUUFBQUEsS0FBSyxFQUFFRjtBQUFaLE9BQUQsQ0FBUDtBQUNEO0FBQ0YsR0FURCxDQURGO0FBQUEsQ0FEaUMsRUFhakMscUJBYmlDLENBQTVCOztBQWlCQSxJQUFNRyxhQUFhLEdBQUcsd0JBQzNCLFVBQUNOLEdBQUQsRUFBTUYsT0FBTixFQUFlQyxLQUFmO0FBQUEsU0FDRSxxQkFBWUMsR0FBWixFQUFpQixVQUFDRSxHQUFELEVBQU1DLE1BQU4sRUFBaUI7QUFDaEMsUUFBSUQsR0FBSixFQUFTO0FBQ1BILE1BQUFBLEtBQUssQ0FBQ0csR0FBRCxDQUFMO0FBQ0QsS0FGRCxNQUVPO0FBQ0wsVUFBSSxDQUFDQyxNQUFMLEVBQWE7QUFDWEosUUFBQUEsS0FBSyxDQUFDLElBQUlLLEtBQUosQ0FBVSw2QkFBVixDQUFELENBQUw7QUFDRDs7QUFDRE4sTUFBQUEsT0FBTyxDQUFDSyxNQUFELENBQVA7QUFDRDtBQUNGLEdBVEQsQ0FERjtBQUFBLENBRDJCLEVBYTNCLGVBYjJCLENBQXRCO0FBZ0JQO0FBQ0E7QUFDQTs7OztBQUNPLElBQU1JLHlCQUF5QixHQUFHbkIsa0JBQUtDLFdBQUwsQ0FDdkM7QUFBQSxNQUFFbUIsUUFBRixTQUFFQSxRQUFGO0FBQUEsTUFBWUMsT0FBWixTQUFZQSxPQUFaO0FBQUEsU0FBeUJELFFBQVEsQ0FBQ0UsU0FBVCxDQUFtQkQsT0FBbkIsQ0FBekI7QUFBQSxDQUR1QyxFQUd2QywyQkFIdUMsQ0FBbEM7Ozs7QUFNQSxJQUFNRSxtQkFBbUIsR0FBR3ZCLGtCQUFLQyxXQUFMLENBQ2pDO0FBQUEsTUFBRW1CLFFBQUYsU0FBRUEsUUFBRjtBQUFBLE1BQVlDLE9BQVosU0FBWUEsT0FBWjtBQUFBLFNBQXlCRCxRQUFRLENBQUNJLFdBQVQsQ0FBcUJILE9BQXJCLENBQXpCO0FBQUEsQ0FEaUMsRUFHakMscUJBSGlDLENBQTVCOzs7O0FBTUEsSUFBTUksbUJBQW1CLEdBQUd6QixrQkFBS0MsV0FBTCxDQUNqQyxVQUFBbUIsUUFBUTtBQUFBLFNBQUlBLFFBQVEsQ0FBQ00sUUFBVCxFQUFKO0FBQUEsQ0FEeUIsRUFHakMscUJBSGlDLENBQTVCO0FBS1A7QUFDQTtBQUNBOzs7OztBQUNPLElBQU1DLFdBQVcsR0FBRzNCLGtCQUFLNEIsWUFBTCxDQUN6QixVQUFDQyxDQUFELEVBQUlDLEVBQUo7QUFBQSxTQUFXQSxFQUFFLEVBQWI7QUFBQSxDQUR5QixFQUd6QixhQUh5QixDQUFwQjs7OztBQU1BLElBQU1DLFVBQVUsR0FBRy9CLGtCQUFLNEIsWUFBTCxDQUN4QixVQUFDSSxLQUFELEVBQVFGLEVBQVI7QUFBQSxTQUFlRyxNQUFNLENBQUNDLFVBQVAsQ0FBa0I7QUFBQSxXQUFNSixFQUFFLEVBQVI7QUFBQSxHQUFsQixFQUE4QkUsS0FBOUIsQ0FBZjtBQUFBLENBRHdCLEVBR3hCLFlBSHdCLENBQW5COzs7O0FBTUEsSUFBTUcsV0FBVyxHQUFHbkMsa0JBQUtDLFdBQUwsQ0FDekIsVUFBQW1DLE9BQU87QUFBQSxTQUFJQSxPQUFKO0FBQUEsQ0FEa0IsRUFHekIsUUFIeUIsQ0FBcEIiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIDIwMjIgVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4vLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4vLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1Jcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4vLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuLy8gVEhFIFNPRlRXQVJFLlxuXG5pbXBvcnQgVGFzaywge3Rhc2tDcmVhdG9yfSBmcm9tICdyZWFjdC1wYWxtL3Rhc2tzJztcbmltcG9ydCB7anNvbiBhcyByZXF1ZXN0SnNvbn0gZnJvbSAnZDMtcmVxdWVzdCc7XG5pbXBvcnQge3JlYWRGaWxlSW5CYXRjaGVzLCBwcm9jZXNzRmlsZURhdGF9IGZyb20gJy4uL3Byb2Nlc3NvcnMvZmlsZS1oYW5kbGVyJztcblxuZXhwb3J0IGNvbnN0IExPQURfRklMRV9UQVNLID0gVGFzay5mcm9tUHJvbWlzZShcbiAgKHtmaWxlLCBmaWxlQ2FjaGUsIGxvYWRlcnMsIGxvYWRPcHRpb25zfSkgPT5cbiAgICByZWFkRmlsZUluQmF0Y2hlcyh7ZmlsZSwgZmlsZUNhY2hlLCBsb2FkZXJzLCBsb2FkT3B0aW9uc30pLFxuICAnTE9BRF9GSUxFX1RBU0snXG4pO1xuXG5leHBvcnQgY29uc3QgUFJPQ0VTU19GSUxFX0RBVEEgPSBUYXNrLmZyb21Qcm9taXNlKFxuICBwcm9jZXNzRmlsZURhdGEsXG5cbiAgJ1BST0NFU1NfRklMRV9DT05URU5UJ1xuKTtcblxuZXhwb3J0IGNvbnN0IEdFT0NPRElOR19HT09HTEVfUkVRVUVTVCA9IFRhc2suZnJvbVByb21pc2UoXG4gICdMT0FEX0dFT0NPRElOR19SRVNVTFQnXG4pXG5cbi8vIGV4cG9ydCBjb25zdCBQTEFDRV9ERVRBSUxfVEFTSyA9IHRhc2tDcmVhdG9yKFxuICAgICAgLy8gcmVxdWVzdEpzb24odXJsLChlcnIscmVzdWx0KSlcbi8vIClcblxuLy8gZXhwb3J0IGNvbnN0IFBST0NFU1NfTEFZRVJfVEFTSyA9IHRhc2tDcmVhdG9yKHtcbi8vICAgcHJvY2Vzc0xheWVyRGF0YSxcbi8vICAgJ1BST0NFU1NfTEFZRVJfVEFTSydcbi8vIH0pXG5cbmV4cG9ydCBjb25zdCBMT0FEX01BUF9TVFlMRV9UQVNLID0gdGFza0NyZWF0b3IoXG4gICh7dXJsLCBpZH0sIHN1Y2Nlc3MsIGVycm9yKSA9PlxuICAgIHJlcXVlc3RKc29uKHVybCwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGVycm9yKGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgIGVycm9yKG5ldyBFcnJvcignTWFwIHN0eWxlIHJlc3BvbnNlIGlzIGVtcHR5JykpO1xuICAgICAgICB9XG4gICAgICAgIHN1Y2Nlc3Moe2lkLCBzdHlsZTogcmVzdWx0fSk7XG4gICAgICB9XG4gICAgfSksXG5cbiAgJ0xPQURfTUFQX1NUWUxFX1RBU0snXG4pO1xuXG5cbmV4cG9ydCBjb25zdCBMT0FEX0FQSV9UQVNLID0gdGFza0NyZWF0b3IoXG4gICh1cmwsIHN1Y2Nlc3MsIGVycm9yKSA9PlxuICAgIHJlcXVlc3RKc29uKHVybCwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGVycm9yKGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgIGVycm9yKG5ldyBFcnJvcignTWFwIHN0eWxlIHJlc3BvbnNlIGlzIGVtcHR5JykpO1xuICAgICAgICB9XG4gICAgICAgIHN1Y2Nlc3MocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KSxcblxuICAnTE9BRF9BUElfVEFTSydcbik7XG5cbi8qKlxuICogdGFzayB0byB1cGxvYWQgZmlsZSB0byBjbG91ZCBwcm92aWRlclxuICovXG5leHBvcnQgY29uc3QgRVhQT1JUX0ZJTEVfVE9fQ0xPVURfVEFTSyA9IFRhc2suZnJvbVByb21pc2UoXG4gICh7cHJvdmlkZXIsIHBheWxvYWR9KSA9PiBwcm92aWRlci51cGxvYWRNYXAocGF5bG9hZCksXG5cbiAgJ0VYUE9SVF9GSUxFX1RPX0NMT1VEX1RBU0snXG4pO1xuXG5leHBvcnQgY29uc3QgTE9BRF9DTE9VRF9NQVBfVEFTSyA9IFRhc2suZnJvbVByb21pc2UoXG4gICh7cHJvdmlkZXIsIHBheWxvYWR9KSA9PiBwcm92aWRlci5kb3dubG9hZE1hcChwYXlsb2FkKSxcblxuICAnTE9BRF9DTE9VRF9NQVBfVEFTSydcbik7XG5cbmV4cG9ydCBjb25zdCBHRVRfU0FWRURfTUFQU19UQVNLID0gVGFzay5mcm9tUHJvbWlzZShcbiAgcHJvdmlkZXIgPT4gcHJvdmlkZXIubGlzdE1hcHMoKSxcblxuICAnR0VUX1NBVkVEX01BUFNfVEFTSydcbik7XG4vKipcbiAqICB0YXNrIHRvIGRpc3BhdGNoIGEgZnVuY3Rpb24gYXMgYSB0YXNrXG4gKi9cbmV4cG9ydCBjb25zdCBBQ1RJT05fVEFTSyA9IFRhc2suZnJvbUNhbGxiYWNrKFxuICAoXywgY2IpID0+IGNiKCksXG5cbiAgJ0FDVElPTl9UQVNLJ1xuKTtcblxuZXhwb3J0IGNvbnN0IERFTEFZX1RBU0sgPSBUYXNrLmZyb21DYWxsYmFjayhcbiAgKGRlbGF5LCBjYikgPT4gd2luZG93LnNldFRpbWVvdXQoKCkgPT4gY2IoKSwgZGVsYXkpLFxuXG4gICdERUxBWV9UQVNLJ1xuKTtcblxuZXhwb3J0IGNvbnN0IFVOV1JBUF9UQVNLID0gVGFzay5mcm9tUHJvbWlzZShcbiAgcHJvbWlzZSA9PiBwcm9taXNlLFxuXG4gICdVTldSQVAnXG4pO1xuIl19